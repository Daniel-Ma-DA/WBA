<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<script>
    function validateNumberInput(input) {
        input.value = input.value.replace(/[^0-9]/g, '');
        updateTotalPrice(input);
    }
    function updateTotalPrice(input) {
        const row = input.parentElement.parentElement; // Holt die aktuelle Zeile (tr)
        const quantity = parseFloat(input.value);
        const pricePerBottle = parseFloat(row.children[2].innerText); // Holt den Preis pro Flasche aus dem dritten td
        const totalPriceElement = row.children[3]; // Die vierte td für den Gesamtpreis

        if (!isNaN(quantity) && !isNaN(pricePerBottle)) {
            const totalPrice = quantity * pricePerBottle;
            totalPriceElement.innerText = totalPrice.toFixed(2); // Zeigt den Gesamtpreis auf zwei Dezimalstellen an
        } else {
            totalPriceElement.innerText = '0.00'; // Setzt den Gesamtpreis auf Null, wenn Eingaben ungültig sind
        }

        updateSum(); // Aktualisiert die Zwischensumme und die Gesamtsumme
    }

    function updateSum() {
        //Summe von Weinen
        let sumWines =0;

        const totalPrices = document.querySelectorAll('.total-price');
        console.log(sumWines)
        // Loop through each total price element
        totalPrices.forEach(td => {
            const value = parseFloat(td.innerHTML);
            if (!isNaN(value)) {
                sumWines += value;
            }
            console.log(sumWines)
        });
         //Addiert mit


        if (document.getElementById('DHL').checked === true) {
            sumWines += parseFloat(document.getElementById('DHLCost').innerText);
        } else if (document.getElementById('Spedition').checked === true) {
            sumWines +=parseFloat(document.getElementById('SpeditionCost').innerText);
        }


        console.log(sumWines)

        document.getElementById('Zwsichensumme').innerText=sumWines.toFixed(2);
        document.getElementById('MwSt').innerText=(sumWines*0.19).toFixed(2);
        document.getElementById('Summe').innerText=(sumWines*1.19).toFixed(2);

    }

    function checkAmountBottles() {
        let amountBottles = document.querySelectorAll('.quantity')
        let total = 0;
        amountBottles.forEach(input => {
            const value = parseFloat(input.value);
            if (!isNaN(value)) {
                total += value;
            }
        });
        console.log(total)
        if (total>12) {
            document.getElementById('Spedition').checked = true;
        }

    }
</script>
    <table>
        <thead>
        <tr>
            <td>Flaschen</td>
            <td>Weinname</td>
            <td>Einzelflasche</td>
            <td>Preis</td>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td><input type="text" class="quantity"  min="0" oninput="validateNumberInput(this)" onchange="checkAmountBottles()" placeholder="0" ></td>
            <td> Marienthaler Strifsberg Rotweincuvee</td>
            <td>3.60</td>
            <td class="total-price"><span class="total-price">0.00</span></td>
        </tr>
        <tr>
            <td><input type="text" class="quantity" placeholder="0" min="0" oninput="validateNumberInput(this)" onchange="checkAmountBottles()"></td>
            <td>Riesling CLassic</td>
            <td>3.70</td>
            <td class="total-price"><span class="total-price">0.00</span></td>
        </tr>
        <tr>
            <td><input type="text" class="quantity" placeholder="0" min="0" oninput="validateNumberInput(this)" onchange="checkAmountBottles()"></td>
            <td>Silvaner Selection Rheinhessen</td>
            <td>6.90</td>
            <td class="total-price"><span class="total-price">0.00</span></td>
        </tr>
        <tr>
            <td><input type="text" class="quantity" placeholder="0" min="0" oninput="validateNumberInput(this)" onchange="checkAmountBottles()"></td>
            <td>Domäne Avelsbach Riesling Sekt</td>
            <td>6.15</td>
            <td class="total-price"><span class="total-price">0.00</span></td>
        </tr>
        <tr>
            <td><input type="radio" name="versand" oninput="checkAmountBottles();updateSum()" id="DHL" ></td>
            <td>Versand DHL(bis 12 Flaschen)</td>
            <td>10.00</td>
            <td><span id="DHLCost">10.00</span></td>
        </tr>
        <tr>
            <td><input type="radio" name="versand" oninput="updateSum()" id="Spedition"></input></td>
            <td>Versand Spedition</td>
            <td>10.00</td>
            <td><span id="SpeditionCost">15.00</span></td>
        </tr>
        <tr>
            <td></td>
            <td></td>
            <td>Zwischensumme</td>
            <td><span id="Zwsichensumme"></span></td>
        </tr>
        <tr>
            <td></td>
            <td></td>
            <td>MwSt</td>
            <td><span id="MwSt"></span></td>
        </tr>
        </tbody>
        <tfoot>
        <tr>
            <td></td>
            <td></td>
            <td>Summe</td>
            <td><span id="Summe"></span></td>
        </tr>
        </tfoot>
    </table>
</body>
</html>